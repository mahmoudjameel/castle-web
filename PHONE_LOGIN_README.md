# نظام تسجيل الدخول الجديد - رقم الهاتف والبريد الإلكتروني

## الميزات الجديدة

### 1. التسجيل باستخدام رقم الهاتف أو البريد الإلكتروني
- يمكن للمستخدمين التسجيل باستخدام رقم الهاتف فقط
- يمكن للمستخدمين التسجيل باستخدام البريد الإلكتروني فقط
- يمكن للمستخدمين التسجيل باستخدام كلاهما معاً
- حقل البريد الإلكتروني أصبح اختياري في التسجيل

### 2. تسجيل الدخول باستخدام رقم الهاتف أو البريد الإلكتروني
- خيار للدخول بالبريد الإلكتروني
- خيار للدخول برقم الهاتف
- نفس كلمة المرور لكلا الطريقتين
- تبديل سلس بين طرق الدخول

## التحديثات التقنية

### قاعدة البيانات
- إضافة `@unique` constraint على حقل `phone` في جدول `User`
- دعم `null` values لكل من `email` و `phone`
- migration جديد: `20250831133936_add_phone_unique_constraint`

### API Endpoints

#### `/api/register`
```typescript
// Request Body
{
  name: string,        // مطلوب
  email?: string,      // اختياري
  phone?: string,      // اختياري
  password: string,    // مطلوب
  role: string         // مطلوب
}

// Validation
- يجب إدخال إما email أو phone أو كلاهما
- التحقق من عدم تكرار email إذا تم إدخاله
- التحقق من عدم تكرار phone إذا تم إدخاله
```

#### `/api/login`
```typescript
// Request Body
{
  email?: string,      // مطلوب إذا كان loginMethod = 'email'
  phone?: string,      // مطلوب إذا كان loginMethod = 'phone'
  password: string,    // مطلوب
  loginMethod: string  // 'email' أو 'phone'
}

// Response
{
  message: string,
  user: {
    id: number,
    name: string,
    email: string | null,
    phone: string | null,
    role: string
  }
}
```

### الواجهات الأمامية

#### صفحة التسجيل (`/register`)
- إضافة حقل رقم الهاتف
- حقل البريد الإلكتروني أصبح اختياري
- التحقق من إدخال إما البريد أو الهاتف
- تصميم محسن مع أيقونات مناسبة

#### صفحة تسجيل الدخول (`/login`)
- أزرار تبديل بين طرق الدخول
- حقل ديناميكي يتغير حسب الطريقة المختارة
- أيقونات مناسبة لكل طريقة
- تصميم متجاوب ومحسن

## كيفية الاستخدام

### للمستخدمين الجدد
1. الذهاب إلى `/register`
2. اختيار نوع الحساب (مستخدم عادي أو موهبة)
3. إدخال الاسم (مطلوب)
4. إدخال البريد الإلكتروني أو رقم الهاتف (أحدهما مطلوب على الأقل)
5. إدخال كلمة المرور
6. الموافقة على الشروط
7. إنشاء الحساب

### للمستخدمين الحاليين
1. الذهاب إلى `/login`
2. اختيار طريقة الدخول (بريد إلكتروني أو رقم هاتف)
3. إدخال البيانات المطلوبة
4. إدخال كلمة المرور
5. تسجيل الدخول

## الأمان والتحقق

### التحقق من التكرار
- لا يمكن استخدام نفس البريد الإلكتروني لأكثر من حساب
- لا يمكن استخدام نفس رقم الهاتف لأكثر من حساب
- رسائل خطأ واضحة في حالة التكرار

### التحقق من صحة البيانات
- التحقق من وجود البيانات المطلوبة
- رسائل خطأ واضحة ومفيدة
- تحقق من صحة تنسيق البريد الإلكتروني

## التوافق

### المتصفحات
- متوافق مع جميع المتصفحات الحديثة
- تصميم متجاوب للهواتف والأجهزة اللوحية

### قاعدة البيانات
- PostgreSQL
- Prisma ORM
- Migrations تلقائية

## الخطوات المستقبلية

### تحسينات مقترحة
1. إضافة التحقق من رقم الهاتف عبر SMS
2. إضافة التحقق من البريد الإلكتروني
3. دعم تسجيل الدخول بالهاتف المحمول
4. إضافة خيار "تذكرني"
5. إضافة المصادقة الثنائية

### الأمان
1. تشفير كلمات المرور باستخدام bcrypt
2. إضافة rate limiting للـ API
3. إضافة CSRF protection
4. إضافة session management محسن

## الدعم

لأي استفسارات أو مشاكل تقنية، يرجى التواصل مع فريق التطوير.
